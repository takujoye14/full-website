import{_,u as $,r as s,o as j,c as u,a,b as v,w as h,v as m,d as C,t as w,e as P,f as D,g as c}from"./index-sQOn61nz.js";const B={class:"edit-product"},N={key:0,class:"success"},S={key:1,class:"error"},V={class:"delete-section"},A={key:0,class:"confirm-popup"},I={class:"actions"},M={__name:"EditProduct",setup(F){const g=$(),k=D(),p=g.params.id,f=s(!1),n=s(""),l=s(""),i=s(0),y=s([]),d=s(""),r=s(""),b=t=>{y.value=Array.from(t.target.files)};j(async()=>{try{const t=localStorage.getItem("token"),o=await(await fetch(`http://localhost:3000/api/products/${p}`,{headers:{Authorization:`Bearer ${t}`}})).json();n.value=o.productName,l.value=o.description,i.value=o.price}catch{r.value="Failed to fetch product."}});const x=async()=>{d.value="",r.value="";const t=new FormData;t.append("productName",n.value),t.append("description",l.value),t.append("price",i.value),y.value.forEach(e=>{t.append("images",e)});try{const e=localStorage.getItem("token");if(!(await fetch(`http://localhost:3000/api/products/edit/${p}`,{method:"PUT",headers:{Authorization:`Bearer ${e}`},body:t})).ok)throw new Error("Edit failed.");d.value="✅ Product updated!",setTimeout(()=>k.push("/products"),1500)}catch(e){r.value=e.message}},E=async()=>{try{const t=localStorage.getItem("token"),e=await fetch(`http://localhost:3000/api/products/delete/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}),o=await e.json();if(!e.ok)throw new Error(o.message||"Delete failed");alert("Product deleted successfully"),k.push("/products")}catch(t){alert("Failed to delete product: "+t.message)}};return(t,e)=>(c(),u("div",B,[e[8]||(e[8]=a("h1",null,"Edit Product",-1)),a("form",{onSubmit:C(x,["prevent"]),enctype:"multipart/form-data"},[h(a("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),type:"text",placeholder:"Product Name",required:""},null,512),[[m,n.value]]),h(a("textarea",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),placeholder:"Description",required:""},null,512),[[m,l.value]]),h(a("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>i.value=o),type:"number",placeholder:"Price (€)",required:""},null,512),[[m,i.value,void 0,{number:!0}]]),a("input",{type:"file",onChange:b,accept:".jpg,.jpeg,.png,.svg",multiple:""},null,32),e[5]||(e[5]=a("button",{type:"submit"},"Save Changes",-1))],32),d.value?(c(),u("p",N,w(d.value),1)):v("",!0),r.value?(c(),u("p",S,w(r.value),1)):v("",!0),a("div",V,[a("button",{class:"button",type:"button",onClick:e[3]||(e[3]=o=>f.value=!0)},e[6]||(e[6]=[P('<span class="button__text" data-v-89fffba3>Delete</span><span class="button__icon" data-v-89fffba3><svg class="svg" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg" data-v-89fffba3><path d="M112,112l20,320c.95,18.49,14.4,32,32,32H348c17.67,0,30.87-13.51,32-32l20-320" style="fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px;" data-v-89fffba3></path><line x1="80" x2="432" y1="112" y2="112" style="stroke:#fff;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px;" data-v-89fffba3></line><path d="M192,112V72h0a23.93,23.93,0,0,1,24-24h80a23.93,23.93,0,0,1,24,24h0v40" style="fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px;" data-v-89fffba3></path><line x1="256" x2="256" y1="176" y2="400" style="fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px;" data-v-89fffba3></line><line x1="184" x2="192" y1="176" y2="400" style="fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px;" data-v-89fffba3></line><line x1="328" x2="320" y1="176" y2="400" style="fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px;" data-v-89fffba3></line></svg></span>',2)])),f.value?(c(),u("div",A,[e[7]||(e[7]=a("p",null,"Are you sure you want to delete this product?",-1)),a("div",I,[a("button",{class:"confirm",onClick:E},"Yes, delete"),a("button",{class:"cancel",onClick:e[4]||(e[4]=o=>f.value=!1)},"Cancel")])])):v("",!0)])]))}},U=_(M,[["__scopeId","data-v-89fffba3"]]);export{U as default};
